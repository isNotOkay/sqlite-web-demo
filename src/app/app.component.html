<div class="layout">
  <!-- LEFT: Static list with sections (flat) -->
  <aside class="sidenav">
    <nav class="nav-list" role="navigation" aria-label="Database objects">

      <!-- Tables -->
      <div class="nav-section" role="group" aria-label="Tables">
        <div class="nav-section-label">Tables</div>
        @for (item of tableItems(); track item.id) {
          <button
            type="button"
            class="nav-item selectable"
            [class.selected]="selectedListItem()?.id === item.id && selectedListItem()?.relationType === item.relationType"
            [attr.aria-current]="selectedListItem()?.id === item.id && selectedListItem()?.relationType === item.relationType ? 'true' : null"
            (click)="selectItem(item)">
            {{ item.label }}
          </button>
        }
        @if (tableItems().length === 0) {
          <div class="nav-empty">No tables found</div>
        }
      </div>

      <mat-divider></mat-divider>

      <!-- Views -->
      <div class="nav-section" role="group" aria-label="Views">
        <div class="nav-section-label">Views</div>
        @for (item of viewItems(); track item.id) {
          <button
            type="button"
            class="nav-item selectable"
            [class.selected]="selectedListItem()?.id === item.id && selectedListItem()?.relationType === item.relationType"
            [attr.aria-current]="selectedListItem()?.id === item.id && selectedListItem()?.relationType === item.relationType ? 'true' : null"
            (click)="selectItem(item)">
            {{ item.label }}
          </button>
        }
        @if (viewItems().length === 0) {
          <div class="nav-empty">No views found</div>
        }
      </div>
    </nav>
  </aside>

  <!-- RIGHT: Dynamic grid + paginator -->
  <section class="content" style="position: relative;">
    @if (loading()) {
      <app-loading-indicator/>
    }

    <div class="table-container">
      <table
        class="striped"
        mat-table
        [dataSource]="rows()"
        matSort
        [matSortDisabled]="columnNames().length === 0"
        (matSortChange)="onSort($event)"
      >
        @for (columnName of columnNames(); track columnName) {
          <ng-container [matColumnDef]="columnName">
            <th
              mat-header-cell
              *matHeaderCellDef
              sticky
              [mat-sort-header]="columnName">
              {{ columnName }}
            </th>
            <td
              mat-cell
              *matCellDef="let row"
              [class.numeric]="isNumber(row[columnName])">
              {{ row[columnName] }}
            </td>
          </ng-container>
        }
        <tr mat-header-row *matHeaderRowDef="columnNames(); sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: columnNames();"></tr>
      </table>
    </div>

    <mat-paginator
      [length]="totalCount()"
      [pageIndex]="pageIndex()"
      [pageSize]="pageSize()"
      [hidePageSize]="true"
      showFirstLastButtons
      class="footer-paginator"
      (page)="onPage($event)">
    </mat-paginator>
  </section>
</div>
