<!-- src/app/app.html -->
<div class="layout">
  <!-- LEFT: Static list with sections (flat) -->
  <aside class="sidenav">
    <nav class="nav-list" role="navigation" aria-label="Database objects">

      <!-- Tables -->
      <div class="nav-section" role="group" aria-label="Tables">
        <div class="nav-section-label">Tables</div>
        @for (item of items; track item.id) {
          @if (item.kind === 'table') {
            <button
              type="button"
              class="nav-item selectable"
              [class.selected]="selected?.id === item.id && selected?.kind === item.kind"
              [attr.aria-current]="selected?.id === item.id && selected?.kind === item.kind ? 'true' : null"
              (click)="selectItem(item)">
              {{ item.label }}
            </button>
          }
        }
        @if (!hasKind('table')) {
          <div class="nav-empty">No tables found</div>
        }
      </div>

      <mat-divider></mat-divider>

      <!-- Views -->
      <div class="nav-section" role="group" aria-label="Views">
        <div class="nav-section-label">Views</div>
        @for (item of items; track item.id) {
          @if (item.kind === 'view') {
            <button
              type="button"
              class="nav-item selectable"
              [class.selected]="selected?.id === item.id && selected?.kind === item.kind"
              [attr.aria-current]="selected?.id === item.id && selected?.kind === item.kind ? 'true' : null"
              (click)="selectItem(item)">
              {{ item.label }}
            </button>
          }
        }
        @if (!hasKind('view')) {
          <div class="nav-empty">No views found</div>
        }
      </div>
    </nav>
  </aside>

  <!-- RIGHT: Dynamic grid + paginator -->
  <section class="content" style="position: relative;">
    @if (loading()) {
      <app-loading-indicator />
    }

    <div class="table-container">
      <table
        class="striped"
        mat-table
        [dataSource]="rows"
        matSort
        [matSortDisabled]="columns.length === 0"
        (matSortChange)="onSort($event)"
      >
        @for (col of columns; track col) {
          <ng-container [matColumnDef]="col">
            <th
              mat-header-cell
              *matHeaderCellDef
              sticky
              mat-sort-header="{{ col }}">
              {{ col }}
            </th>
            <td
              mat-cell
              *matCellDef="let row"
              [class.numeric]="isNumericColumn(col)">
              {{ row[col] }}
            </td>
          </ng-container>
        }
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <mat-paginator
      [length]="total"
      [pageIndex]="pageIndex"
      [pageSize]="pageSize"
      [hidePageSize]="true"
      showFirstLastButtons
      class="footer-paginator"
      (page)="onPage($event)">
    </mat-paginator>
  </section>
</div>
